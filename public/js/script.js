$(function(){function t(e){$("#teks-error-uploadify").text(e);$("#error-uploadify").fadeIn("fast")}function n(e,t){$("#foto").prop("src",e).data("nama",t);$("#menu").fadeIn("fast");$("#tombol-foto").fadeOut("fast")}function r(e){$("#teks-error-webcam").text(e);$("#error-webcam").fadeIn("fast");$("#unggah-webcam").prop("disabled",false)}function i(e,t){$("#foto").prop("src",e).data("nama",t);$("#menu").fadeIn("fast");$(".modal").modal("hide");$("#tombol-foto, .modal").remove()}function s(e){$("#w").val(e.w);$("#h").val(e.h);$("#x").val(e.x);$("#y").val(e.y)}function o(){$("#hilang-potong").fadeIn("fast")}function u(){$("#hilang-potong").fadeOut("fast")}function a(e){$("#teks-error-potong").text(e);$("#error-potong").fadeIn("fast");l()}function f(e){$("#foto").prop("src",e).css("display","none").css("width","").css("height","");l()}function l(){e.destroy()}function c(e){Caman("#foto",function(){this.render();$("#foto").data("nama",e)})}function h(e){$("#teks-error-filter").text(e);$("#error-filter").fadeIn("fast")}function p(){$("#teks-error-filter").text("");$("#error-filter").fadeOut("fast")}function d(e,t){var n=$("#unduh");n.prop("download",t);if(e=="revert"){n.fadeOut("fast")}else{n.fadeIn("fast")}}var e;webcam.set_swf_url(swf_webcam);webcam.set_api_url(url_webcam);webcam.set_quality(90);webcam.set_shutter_sound(false);webcam.set_hook("onComplete",function(e){var t=$.parseJSON(e);if(t.status=="error"){var n=t.pesan;r(n)}else{var s=t.foto;var o=t.nama;i(s,o)}});webcam.set_hook("onError",function(e){$(".modal-body").html(e)});$("#input-uploadify").uploadify({swf:swf_uploadify,uploader:url_uploadify,buttonClass:"btn btn-danger",buttonText:"Pilih Foto",fileObjName:"foto",multi:false,removeTimeout:0,width:100,onUploadSuccess:function(e,r,i){var s=$.parseJSON(r);if(s.status=="error"){var o=s.pesan;t(o)}else{var u=s.foto;var a=s.nama;n(u,a)}}});$("#ambil-foto").click(function(){var e=webcam.get_html(600,400);$(".modal-body").html(e);$(".modal").modal("show")});$("#pengaturan-webcam").click(function(){webcam.configure("camera")});$("#unggah-webcam").click(function(){$(this).prop("disabled",true);webcam.snap();webcam.reset()});$("#batal-webcam").click(function(){$(".modal-body").html("");$("#teks-error-webcam").text("");$("#error-webcam").fadeOut("fast");$("#unggah-webcam").prop("disabled",false)});$("#potong-foto").click(function(){var t=200;var n=200;var r=$("#foto").prop("width");var i=$("#foto").prop("height");var a=r/2-t/2;var f=i/2-n/2;var l=a+t;var c=f+n;$("#foto").Jcrop({bgOpacity:.2,minSize:[100,100],setSelect:[a,f,l,c],onChange:s,onSelect:o,onRelease:u},function(){e=this});o();$(this).prop("disabled",true)});$("#batal-potong").click(function(){l();u();$("#potong-foto").prop("disabled",false)});$("#simpan-potong").click(function(){var e=$("#w").val();var t=$("#h").val();var n=$("#x").val();var r=$("#y").val();var i=$("#foto").data("nama");u();l();$.post(url_crop,{w:e,h:t,x:n,y:r,nama:i},function(e){if(e.status=="error"){var t=e.pesan;a(t)}else{var n=e.foto;f(n)}},"json");$("#potong-foto").prop("disabled",false)});$("#filter-foto").click(function(){var e=$("#foto").data("nama");c(e);$("#filters").fadeIn("fast");$("#tombol-foto, #menu, .modal").remove()});$("#filter button").click(function(){var e=$("#filter button");var t=$(this);var n=t.prop("id");var r=t.text();if(t.is(".active")){return false}e.removeClass("active");t.addClass("active");Caman("#foto",function(){if(n in this){this.revert();this[n]();this.render(function(){var e=this.toBase64();var t=$("#foto").data("nama");$.post(url_filter,{foto:e,nama:t},function(e){if(e.status=="error"){var t=e.pesan;h(t)}else{var n=$.parseJSON(e);console.log(e);p()}},"json")});d(n,r)}else{var e=$("#unduh");e.fadeOut("fast")}})});$("#unduh").click(function(){var e=document.getElementById("foto");var t=e.toDataURL("image/png;base64;");var n=$("#unduh");n.prop("href",t)})})